---
import type { CollectionEntry } from 'astro:content';
import FormattedDate from './FormattedDate.astro';
import Tag from './Tag.astro';

interface Props {
  album: CollectionEntry<'photos'>;
}

const { album } = Astro.props;
const { title, pubDate, location, tags, cover, photos } = album.data;
const href = `/photos/${album.id.replace(/\.mdx?$/, '')}/`;
---

<a href={href} class="album-card">
  <div class="album-cover">
    <img src={cover} alt={title} loading="lazy" />
    <span class="photo-count">{photos.length} photos</span>
  </div>
  <div class="album-info">
    <span class="album-title">{title}</span>
    <span class="album-meta">
      <FormattedDate date={pubDate} />
      {location && <span class="album-location"> Â· {location}</span>}
    </span>
    {
      tags.length > 0 && (
        <span class="album-tags">
          {tags.map((tag) => (
            <Tag tag={tag} />
          ))}
        </span>
      )
    }
  </div>
</a>

<style>
  .album-card {
    display: block;
    text-decoration: none;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 8px;
    overflow: hidden;
    transition: border-color 0.15s ease;
  }

  .album-card:hover {
    border-color: rgba(255, 255, 255, 0.2);
  }

  .album-cover {
    position: relative;
    aspect-ratio: 3 / 2;
    overflow: hidden;
  }

  .album-cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .album-card:hover .album-cover img {
    transform: scale(1.03);
  }

  .photo-count {
    position: absolute;
    bottom: 0.5rem;
    right: 0.5rem;
    background: rgba(0, 0, 0, 0.7);
    color: rgba(255, 255, 255, 0.9);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
  }

  .album-info {
    padding: 1rem 1.25rem;
  }

  .album-title {
    display: block;
    color: rgb(var(--black));
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 0.25rem;
  }

  .album-meta {
    display: block;
    color: rgb(var(--gray));
    font-size: 0.85rem;
    margin-bottom: 0.5rem;
  }

  .album-location {
    color: rgb(var(--gray));
  }

  .album-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
</style>
